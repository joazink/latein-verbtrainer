<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Lateinischer Verbtrainer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#2c3e50">

<style>
body { font-family: Arial, sans-serif; background:#f2f2f2; margin:0; padding:10px; }
h1 { text-align:center; font-size:1.4em; }
nav { text-align:center; margin-bottom:10px; }
button, select, input { padding:6px; margin:3px; font-size:1em; }
section { display:none; background:#fff; padding:10px; border-radius:6px; }
table { border-collapse:collapse; width:100%; font-size:0.9em; }
th,td { border:1px solid #999; padding:4px; text-align:center; }
.correct { color:green; }
.wrong { color:red; }
#stats { background:#fff; padding:8px; border-radius:6px; margin-bottom:8px; }
</style>
</head>

<body>

<h1>Lateinischer Verbtrainer</h1>

<nav>
<button onclick="show('study')">üìò Lernen</button>
<button onclick="show('write')">‚úçÔ∏è Schreiben</button>
<button onclick="show('analyze')">üîç Analysieren</button>
<button onclick="show('worksheet')">üìù Arbeitsblatt</button>
</nav>

<div id="stats"></div>

<section id="study"></section>
<section id="write"></section>
<section id="analyze"></section>
<section id="worksheet"></section>

<script>
/* ================= PERSONS ================= */
const PERSONS=[
{p:1,n:"sg",l:"1. Sg."},{p:2,n:"sg",l:"2. Sg."},{p:3,n:"sg",l:"3. Sg."},
{p:1,n:"pl",l:"1. Pl."},{p:2,n:"pl",l:"2. Pl."},{p:3,n:"pl",l:"3. Pl."}
];
const idx=(p,n)=>PERSONS.findIndex(x=>x.p===p&&x.n===n);

/* ================= ENDINGS ================= */
const END={
presA:["o","s","t","mus","tis","nt"],
presP:["or","ris","tur","mur","mini","ntur"],
impfA:["bam","bas","bat","bamus","batis","bant"],
impfP:["bar","baris","batur","bamur","bamini","bantur"],
perfA:["i","isti","it","imus","istis","erunt"],
plqA:["eram","eras","erat","eramus","eratis","erant"],
fut2A:["ero","eris","erit","erimus","eritis","erunt"],
konjPresA:["em","es","et","emus","etis","ent"],
konjImpA:["rem","res","ret","remus","retis","rent"]
};

const FUT={
1:["bo","bis","bit","bimus","bitis","bunt"],
2:["bo","bis","bit","bimus","bitis","bunt"],
3:["am","es","et","emus","etis","ent"],
"3io":["iam","ies","iet","iemus","ietis","ient"],
4:["iam","ies","iet","iemus","ietis","ient"]
};

/* ================= VERBS ================= */
const VERBS={
amare:{c:1,p:"ama",pf:"amav"},
monere:{c:2,p:"mone",pf:"monu"},
legere:{c:3,p:"lege",pf:"leg"},
capere:{c:"3io",p:"cape",pf:"cep"},
audire:{c:4,p:"audi",pf:"audiv"},

esse:{irr:true,
pres:["sum","es","est","sumus","estis","sunt"],
impf:["eram","eras","erat","eramus","eratis","erant"],
fut:["ero","eris","erit","erimus","eritis","erunt"],
perf:["fui","fuisti","fuit","fuimus","fuistis","fuerunt"],
plq:["fueram","fueras","fuerat","fueramus","fueratis","fuerant"]
},

ire:{irr:true,
pres:["eo","is","it","imus","itis","eunt"],
impf:["ibam","ibas","ibat","ibamus","ibatis","ibant"],
fut:["ibo","ibis","ibit","ibimus","ibitis","ibunt"],
perf:["ii","isti","iit","iimus","istis","ierunt"],
plq:["ieram","ieras","ierat","ieramus","ieratis","ierant"]
},

ferre:{irr:true,
pres:["fero","fers","fert","ferimus","fertis","ferunt"],
impf:["ferebam","ferebas","ferebat","ferebamus","ferebatis","ferebant"],
fut:["feram","feres","feret","feremus","feretis","ferent"],
perf:["tuli","tulisti","tulit","tulimus","tulistis","tulerunt"],
plq:["tuleram","tuleras","tulerat","tuleramus","tuleratis","tulerant"]
}
};

/* ================= CONJUGATION ================= */
function conj({v,modus,tempus,genus,p,n}){
const i=idx(p,n),V=VERBS[v];
if(V.irr){
if(tempus==="praesens")return V.pres[i];
if(tempus==="imperfekt")return V.impf[i];
if(tempus==="futur1")return V.fut[i];
if(tempus==="perfekt")return V.perf[i];
if(tempus==="plusquamperfekt")return V.plq[i];
}
if(modus==="konjunktiv"){
if(tempus==="praesens")return V.p+END.konjPresA[i];
if(tempus==="imperfekt")return V.p+"re"+END.konjImpA[i];
}
if(genus==="aktiv"){
if(tempus==="praesens")return V.p+END.presA[i];
if(tempus==="imperfekt")return V.p+END.impfA[i];
if(tempus==="futur1")return V.p+FUT[V.c][i];
if(tempus==="perfekt")return V.pf+END.perfA[i];
if(tempus==="plusquamperfekt")return V.pf+END.plqA[i];
if(tempus==="futur2")return V.pf+END.fut2A[i];
}
if(genus==="passiv"){
if(tempus==="praesens")return V.p+END.presP[i];
if(tempus==="imperfekt")return V.p+END.impfP[i];
}
return "‚Äî";
}

/* ================= DIFFICULTY ================= */
const DIFFICULTY={
easy:{verbs:["amare","monere","audire"],t:["praesens","imperfekt"],m:["indikativ"],g:["aktiv"]},
medium:{verbs:["amare","monere","legere","capere","audire","esse"],t:["praesens","imperfekt","futur1","perfekt"],m:["indikativ"],g:["aktiv","passiv"]},
hard:{verbs:Object.keys(VERBS),t:["praesens","imperfekt","futur1","perfekt","plusquamperfekt","futur2"],m:["indikativ","konjunktiv"],g:["aktiv","passiv"]}
};
const diff=()=>DIFFICULTY[document.getElementById("difficulty").value];

/* ================= PROGRESS ================= */
function loadP(){return JSON.parse(localStorage.getItem("latinP"))||{t:0,c:0,s:0}}
function saveP(p){localStorage.setItem("latinP",JSON.stringify(p))}
function record(ok){
const p=loadP();p.t++;if(ok)p.c++;p.s=ok?p.s+1:0;saveP(p);renderStats();
}
function renderStats(){
const p=loadP();
document.getElementById("stats").innerHTML=
`üìä ${p.c}/${p.t} richtig (${p.t?Math.round(p.c/p.t*100):0}%) ‚Äì Serie: ${p.s}`;
}

/* ================= UI ================= */
function show(id){
document.querySelectorAll("section").forEach(s=>s.style.display="none");
document.getElementById(id).style.display="block";
if(id==="study")study();
if(id==="write")write();
if(id==="analyze")analyze();
if(id==="worksheet")worksheet();
}

/* STUDY */
function study() {
  const tenses = [
    { label: "Praesens Aktiv", tempus: "praesens", modus: "indikativ", genus: "aktiv" },
    { label: "Imperfekt Aktiv", tempus: "imperfekt", modus: "indikativ", genus: "aktiv" },
    { label: "Futur I Aktiv", tempus: "futur1", modus: "indikativ", genus: "aktiv" },
    { label: "Perfekt Aktiv", tempus: "perfekt", modus: "indikativ", genus: "aktiv" },
    { label: "Plusquamperfekt Aktiv", tempus: "plusquamperfekt", modus: "indikativ", genus: "aktiv" },
    { label: "Futur II Aktiv", tempus: "futur2", modus: "indikativ", genus: "aktiv" },

    { label: "Praesens Passiv", tempus: "praesens", modus: "indikativ", genus: "passiv" },
    { label: "Imperfekt Passiv", tempus: "imperfekt", modus: "indikativ", genus: "passiv" },

    { label: "Konjunktiv Praesens", tempus: "praesens", modus: "konjunktiv", genus: "aktiv" },
    { label: "Konjunktiv Imperfekt", tempus: "imperfekt", modus: "konjunktiv", genus: "aktiv" }
  ];

  let html = "<h2>Lernmodus ‚Äì nach Tempus</h2>";

  for (const v in VERBS) {
    html += `<h3>${v}</h3>`;

    for (const t of tenses) {
      html += `<h4>${t.label}</h4>`;
      html += "<table><tr>";

      PERSONS.forEach(p => {
        html += `<th>${p.l}</th>`;
      });

      html += "</tr><tr>";

      PERSONS.forEach(p => {
        const form = conj({
          v,
          modus: t.modus,
          tempus: t.tempus,
          genus: t.genus,
          p: p.p,
          n: p.n
        });
        html += `<td>${form}</td>`;
      });

      html += "</tr></table><br>";
    }
  }

  document.getElementById("study").innerHTML = html;

}

/* WRITE */
let current=null;
function write(){
  const container = document.getElementById("write");

  container.innerHTML = `
    <h2>Schreibmodus</h2>
    <label>
      Schwierigkeit:
      <select id="writeDiff">
        <option value="easy">Leicht</option>
        <option value="medium">Mittel</option>
        <option value="hard">Schwer</option>
      </select>
    </label>
    <div id="writeTask"></div>
  `;

  generateWriteTask();

}

let currentAnswer = "";

function generateWriteTask(){
  const level = document.getElementById("writeDiff").value;
  const d = DIFFICULTY[level];

  const v = d.verbs[Math.random() * d.verbs.length | 0];
  const tempus = d.t[Math.random() * d.t.length | 0];
  const modus = d.m[Math.random() * d.m.length | 0];
  const genus = d.g[Math.random() * d.g.length | 0];
  const p = PERSONS[Math.random() * 6 | 0];

  currentAnswer = conj({
    v, modus, tempus, genus,
    p: p.p, n: p.n
  });

  document.getElementById("writeTask").innerHTML = `
    <p>
      <b>${v}</b> ‚Äì ${modus} ‚Äì ${tempus} ‚Äì ${genus} ‚Äì ${p.l}
    </p>
    <input id="userAnswer">
    <button id="checkBtn">Pr√ºfen</button>
    <button id="nextBtn">Neu</button>
    <p id="feedback"></p>
  `;

  document.getElementById("checkBtn").onclick = () => {
    const user = document.getElementById("userAnswer").value.trim();
    const ok = user === currentAnswer;
    record(ok);
    document.getElementById("feedback").innerHTML =
      ok
        ? `<span class="correct">‚úîÔ∏è Richtig</span>`
        : `<span class="wrong">‚ùå ${currentAnswer}</span>`;
  };

  document.getElementById("nextBtn").onclick = generateWriteTask; }

  
function newWriteTask(){
  const level=document.getElementById("writeDiff").value;
  const d=DIFFICULTY[level];
  const v=d.verbs[Math.random()*d.verbs.length|0];
  const tempus=d.t[Math.random()*d.t.length|0];
  const modus=d.m[Math.random()*d.m.length|0];
  const genus=d.g[Math.random()*d.g.length|0];
  const p=PERSONS[Math.random()*6|0];
  current=conj({v,modus,tempus,genus,p:p.p,n:p.n});

  document.getElementById("writeTask").innerHTML = `
    <p><b>${v}</b> ‚Äì ${modus} ‚Äì ${tempus} ‚Äì ${genus} ‚Äì ${p.l}</p>
    <input id="ans">
    <button onclick="check()">Pr√ºfen</button>
    <button onclick="newWriteTask()">Neu</button>
    <p id="fb"></p>
  `;
}

/* ANALYZE */
let solution=null;
function analyze(){
  const container = document.getElementById("analyze");

  container.innerHTML = `
    <h2>Analysemodus</h2>
    <label>
      Schwierigkeit:
      <select id="anDiff">
        <option value="easy">Leicht</option>
        <option value="medium">Mittel</option>
        <option value="hard">Schwer</option>
      </select>
    </label>
    <div id="anTask"></div>
  `;

  generateAnalyzeTask();
}

function generateAnalyzeTask(){
  const level = document.getElementById("anDiff").value;
  const d = DIFFICULTY[level];

  const v = d.verbs[Math.random() * d.verbs.length | 0];
  const tempus = d.t[Math.random() * d.t.length | 0];
  const modus = d.m[Math.random() * d.m.length | 0];
  const genus = d.g[Math.random() * d.g.length | 0];
  const p = PERSONS[Math.random() * 6 | 0];

  const form = conj({
    v, modus, tempus, genus,
    p: p.p, n: p.n
  });

  const solution = `${v} ‚Äì ${modus} ‚Äì ${tempus} ‚Äì ${genus} ‚Äì ${p.l}`;

  document.getElementById("anTask").innerHTML = `
    <p><b>${form}</b></p>
    <button id="showSolution">L√∂sung anzeigen</button>
    <button id="nextAnalyze">Neu</button>
  `;

  document.getElementById("showSolution").onclick = () => {
    alert(solution);
  };

  document.getElementById("nextAnalyze").onclick = generateAnalyzeTask; }

  
function newAnalyzeTask(){
  const level=document.getElementById("anDiff").value;
  const d=DIFFICULTY[level];
  const v=d.verbs[Math.random()*d.verbs.length|0];
  const tempus=d.t[Math.random()*d.t.length|0];
  const modus=d.m[Math.random()*d.m.length|0];
  const genus=d.g[Math.random()*d.g.length|0];
  const p=PERSONS[Math.random()*6|0];
  const form=conj({v,modus,tempus,genus,p:p.p,n:p.n});
  solution=`${v} ‚Äì ${modus} ‚Äì ${tempus} ‚Äì ${genus} ‚Äì ${p.l}`;

  document.getElementById("anTask").innerHTML = `
    <p><b>${form}</b></p>
    <p>Was ist die Form?</p>
    <button onclick="alert(solution)">L√∂sung anzeigen</button>
    <button onclick="newAnalyzeTask()">Neu</button>
  `;
}

/* WORKSHEET */
function worksheet(){
  document.getElementById("worksheet").innerHTML = `
    <h2>Arbeitsblatt</h2>
    <label>Schwierigkeit:
      <select id="wsDiff">
        <option value="easy">Leicht</option>
        <option value="medium">Mittel</option>
        <option value="hard">Schwer</option>
      </select>
    </label>
    <button onclick="genWS()">Erzeugen</button>
    <div id="ws"></div>
  `;

}

/* INIT */
renderStats();
show("study");
</script>
</body>
</html>
